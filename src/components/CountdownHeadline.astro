---
import { t } from "astro-i18n";

import Center from "@components/Center.astro";
---

<my-countdown-headline>
  <Center class="pb-1 lg:pb-2">
    <h3 class="text-center font-serif text-2xl lg:text-3xl">{t("countdown.before")}</h3>
  </Center>

  <Center>
    <div class="flex flex-col text-center">
      <span class="font-serif text-6xl lg:text-7xl">
        <span data-id="myCountdownDayValue">00</span>
        {t("countdown.days")}
      </span>
    </div>
  </Center>

  <Center class="pt-2 lg:pt-4">
    <h3 class="text-center font-serif text-2xl lg:text-3xl">{t("countdown.after")}</h3>
  </Center>
</my-countdown-headline>

<script>
  // On November 9, 2025, lunchtime in Belgrade (say 12:00 noon local time CET) is:
  // Belgrade time: 2025-11-09 12:00 CET (UTC+1)
  // UTC time: 2025-11-09 11:00 UTC
  const COUNT_DOWN_DATE = new Date("2025-11-09T11:00:00.000Z").getTime();

  class MyCountdownHeadline extends HTMLElement {
    constructor() {
      super();

      this.setTimeValues();
    }

    private setTimeValues = () => {
      // Find the distance between now and the countdown date
      const distance = new Date().getTime() - COUNT_DOWN_DATE;

      const daysDiff = distance / (1000 * 60 * 60 * 24);

      // Time calculations for days
      const days = Math.floor(daysDiff);

      const el = this.querySelector<HTMLSpanElement>('[data-id="myCountdownDayValue"]');
      if (el != null) {
        el.innerHTML = days.toString();
      }
    };
  }

  // Tell the browser to use our AstroHeart class for <astro-heart> elements.
  customElements.define("my-countdown-headline", MyCountdownHeadline);
</script>
